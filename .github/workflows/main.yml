name: CI
on: [push]
jobs:
  build:
    runs-on: macOS-latest
    steps:
    - name: Checkout
      uses: actions/checkout@v1
#     - name: Force Xcode 11
#       run: sudo xcode-select -switch /Applications/Xcode_11.3.app
    - name: Build
      run: xcodebuild -scheme Sample build CODE_SIGN_IDENTITY="" CODE_SIGNING_REQUIRED="NO" CODE_SIGN_ENTITLEMENTS="" CODE_SIGNING_ALLOWED="NO"
    - name: Check_file & Path
      run: ls -l /Users/runner/Library/Developer/Xcode/DerivedData/Sample-ajkvlmokubtdumcligemudukvmyv/Build/Products/Debug-iphoneos
    
#     - name: Permission
#       run: cd /Users/runner/Library/Developer/Xcode/DerivedData/Sample-ajkvlmokubtdumcligemudukvmyv/Build/Products/Debug-iphoneos && sudo chmod 777 Sample.app   
    - name: Permissions
      run: sudo chmod -R 777 /Users/runner/Library/Developer/Xcode/DerivedData/Sample-ajkvlmokubtdumcligemudukvmyv/Build/Products/Debug-iphoneos
     
#     - name: Push to Releases
#       uses: ncipollo/release-action@v1
#       with:
#           name: kumarvineet011/Swift
#           token: ${{secrets.APP_CENTER_TOKEN}}
#           #group: Test
#           tag: ${{ github.run_number }}
#           artifacts: /Users/runner/Library/Developer/Xcode/DerivedData/Sample-ajkvlmokubtdumcligemudukvmyv/Build/Products/Debug-iphoneos/Sample.app
#           mandatory: true
#           silent: false
#           release_notes: "Deployment successed"  
          
          
   
   
#     - name: Distribute app to App Center
#       uses: akiojin/appcenter-distribute-github-action@v1
#       with:
#           app: kumarvineet011/Swift
#           token: ${{secrets.APP_CENTER_TOKEN}}
#           group: 'Test'
#           build-number: ${{ github.run_number }}
#           #release_name: ${{ github.run_number }}
#           path: /Users/runner/Library/Developer/Xcode/DerivedData/Sample-ajkvlmokubtdumcligemudukvmyv/Build/Products/Debug-iphoneos/Sample.app
#           mandatory: true
#           silent: false
#           #release_notes: "Deployment successed"  

    - name: App Center
        # You may pin to the exact commit or the version.
        # uses: wzieba/AppCenter-Github-Action@650c903ea6a81c71e011b0a303ae555f2dbf76a0
      uses: wzieba/AppCenter-Github-Action@v1.3.3
      with:
          # App name followed by username e.g. wzieba/Sample-App
          appName: kumarvineet011/Swift
          # Upload token - you can get one from appcenter.ms/settings
          token: ${{secrets.APP_CENTER_TOKEN}}
          # Distribution group
          group: 'Test'
          # Artefact to upload (.apk or .ipa)
          file: /Users/runner/Library/Developer/Xcode/DerivedData/Sample-ajkvlmokubtdumcligemudukvmyv/Build/Products/Debug-iphoneos/Sample.app




          
#     - name: Distribute app to App Center
#       uses: akiojin/appcenter-distribute-github-action@v1
#       with:
#           app: kumarvineet011/Swift_React
#           token: ${{secrets.APP_TOKEN}}
#           group: Test
#           build-number: ${{ github.run_number }}
#           path: /Users/runner/Library/Developer/Xcode/DerivedData/Sample-ajkvlmokubtdumcligemudukvmyv/Build/Products/Debug-iphoneos/Sample.app
#           mandatory: true
#           silent: false
#           release_notes: "Deployment successed"

